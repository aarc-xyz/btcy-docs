---
title: "DeFi Integration"
sidebarTitle: "DeFi Protocols"
description: "How to integrate BTCY into DeFi protocols."
---

## Overview

BTCY is designed for seamless DeFi integration. As a standard ERC-20 (ERC-4626), it works with any protocol that supports fungible tokens.

---

## Integration Types

<CardGroup cols={2}>
  <Card title="Lending" icon="hand-holding-dollar">
    Use BTCY as collateral or lendable asset
  </Card>
  <Card title="DEX" icon="arrows-left-right">
    Create liquidity pools with BTCY
  </Card>
  <Card title="Yield" icon="chart-line">
    Integrate into yield strategies
  </Card>
  <Card title="Derivatives" icon="layer-group">
    Use as underlying for derivatives
  </Card>
</CardGroup>

---

## Key Considerations

### 1. ERC-4626 Compatibility

BTCY implements ERC-4626. For protocols that support vault tokens:

```solidity
// Read underlying asset
address underlying = btcy.asset(); // Returns iBTCY address

// Read total assets
uint256 total = btcy.totalAssets();

// Exchange rate is always 1:1
uint256 shares = btcy.convertToShares(assets);
```

### 2. Price Feeds

For protocols requiring price data:

- BTCY value = iBTCY value (1:1 backing)
- iBTCY value = NAV from Pricer contract
- BTC value available from Pricer

```solidity
// Get NAV price
(uint256 nav, ) = pricer.getPrice();

// BTCY price in BTC terms
uint256 btcyPriceInBtc = nav;
```

### 3. Liquidity

Consider:
- Total BTCY supply
- Vault reserves (iBTCY in vault)
- Redemption capacity

---

## Lending Protocol Integration

For lending protocols accepting BTCY as collateral:

```solidity
// 1. User deposits BTCY
btcy.transferFrom(user, address(this), amount);

// 2. Calculate collateral value
(uint256 nav, ) = pricer.getPrice();
uint256 collateralValue = amount * nav / 1e18;

// 3. Apply LTV ratio
uint256 borrowingPower = collateralValue * ltv / 100;
```

### Liquidation Considerations

- NAV updates daily, not continuously
- Consider NAV staleness in liquidation logic
- Redemption requires iBTCY allowlist

---

## DEX Integration

For creating BTCY liquidity pools:

```solidity
// Standard ERC-20 approval and transfer
btcy.approve(address(pool), amount);
pool.addLiquidity(btcy, otherToken, amountBtcy, amountOther);
```

### Pair Recommendations

- BTCY/WBTC — Direct BTC exposure comparison
- BTCY/USDC — Stable pair for trading
- BTCY/ETH — For ETH-based protocols

---

## Events to Index

For off-chain tracking:

```solidity
// Vault deposits/withdrawals
event Deposit(address indexed sender, address indexed owner, uint256 assets, uint256 shares);
event Withdraw(address indexed sender, address indexed receiver, address indexed owner, uint256 assets, uint256 shares);

// Standard transfers
event Transfer(address indexed from, address indexed to, uint256 value);
```

---

<Card title="Contract Events" icon="bolt" href="/developers/integration/events">
  Full event reference for indexing
</Card>
